---

title: Data Callbacks


keywords: fastai
sidebar: home_sidebar

summary: "Callbacks which work with a learner's data"
description: "Callbacks which work with a learner's data"
nb_path: "nbs/14a_callback.data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/14a_callback.data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CollectDataCallback" class="doc_header"><code>class</code> <code>CollectDataCallback</code><a href="https://github.com/fastai/fastai/tree/master/fastai/callback/data.py#L9" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CollectDataCallback</code>(<strong><code>after_create</code></strong>=<em><code>None</code></em>, <strong><code>before_fit</code></strong>=<em><code>None</code></em>, <strong><code>before_epoch</code></strong>=<em><code>None</code></em>, <strong><code>before_train</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_pred</code></strong>=<em><code>None</code></em>, <strong><code>after_loss</code></strong>=<em><code>None</code></em>, <strong><code>before_backward</code></strong>=<em><code>None</code></em>, <strong><code>before_step</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_step</code></strong>=<em><code>None</code></em>, <strong><code>after_step</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_train</code></strong>=<em><code>None</code></em>, <strong><code>after_train</code></strong>=<em><code>None</code></em>, <strong><code>before_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_validate</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_epoch</code></strong>=<em><code>None</code></em>, <strong><code>after_epoch</code></strong>=<em><code>None</code></em>, <strong><code>after_cancel_fit</code></strong>=<em><code>None</code></em>, <strong><code>after_fit</code></strong>=<em><code>None</code></em>) :: <a href="/callback.core.html#Callback"><code>Callback</code></a></p>
</blockquote>
<p>Collect all batches, along with <code>pred</code> and <code>loss</code>, into <code>self.data</code>. Mainly for testing</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WeightedDL" class="doc_header"><code>class</code> <code>WeightedDL</code><a href="https://github.com/fastai/fastai/tree/master/fastai/callback/data.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WeightedDL</code>(<strong><code>dataset</code></strong>=<em><code>None</code></em>, <strong><code>bs</code></strong>=<em><code>None</code></em>, <strong><code>wgts</code></strong>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong><code>num_workers</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>, <strong><code>do_setup</code></strong>=<em><code>True</code></em>, <strong><code>pin_memory</code></strong>=<em><code>False</code></em>, <strong><code>timeout</code></strong>=<em><code>0</code></em>, <strong><code>batch_size</code></strong>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>=<em><code>False</code></em>, <strong><code>indexed</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>persistent_workers</code></strong>=<em><code>False</code></em>, <strong><code>wif</code></strong>=<em><code>None</code></em>, <strong><code>before_iter</code></strong>=<em><code>None</code></em>, <strong><code>after_item</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_iter</code></strong>=<em><code>None</code></em>, <strong><code>create_batches</code></strong>=<em><code>None</code></em>, <strong><code>create_item</code></strong>=<em><code>None</code></em>, <strong><code>create_batch</code></strong>=<em><code>None</code></em>, <strong><code>retain</code></strong>=<em><code>None</code></em>, <strong><code>get_idxs</code></strong>=<em><code>None</code></em>, <strong><code>sample</code></strong>=<em><code>None</code></em>, <strong><code>shuffle_fn</code></strong>=<em><code>None</code></em>, <strong><code>do_batch</code></strong>=<em><code>None</code></em>) :: <a href="/data.core.html#TfmdDL"><code>TfmdDL</code></a></p>
</blockquote>
<p>Weighted dataloader where <code>wgts</code> is used for the training set only</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Datasets.weighted_dataloaders" class="doc_header"><code>Datasets.weighted_dataloaders</code><a href="https://github.com/fastai/fastai/tree/master/fastai/callback/data.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Datasets.weighted_dataloaders</code>(<strong><code>wgts</code></strong>, <strong><code>bs</code></strong>=<em><code>64</code></em>, <strong><code>shuffle_train</code></strong>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>=<em><code>True</code></em>, <strong><code>val_shuffle</code></strong>=<em><code>False</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>'.'</code></em>, <strong><code>dl_type</code></strong>=<em><code>None</code></em>, <strong><code>dl_kwargs</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>=<em><code>None</code></em>, <strong><code>val_bs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create a weighted dataloader <a href="/callback.data.html#WeightedDL"><code>WeightedDL</code></a> with <code>wgts</code> for the training set</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c1"># Dataset of size 10 (train=8, valid=2)</span>
<span class="n">is_valid</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">8</span>
<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">(</span><span class="n">blocks</span><span class="o">=</span><span class="p">[</span><span class="n">CategoryBlock</span><span class="p">],</span> 
    <span class="n">getters</span><span class="o">=</span><span class="p">[</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">lbls</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">splitter</span><span class="o">=</span><span class="n">FuncSplitter</span><span class="p">(</span><span class="n">is_valid</span><span class="p">))</span>
<span class="n">dset</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">datasets</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="n">item_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">ToTensor</span><span class="p">()]</span> 
<span class="n">wgts</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># len(wgts) == 8</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">weighted_dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">wgts</span><span class="o">=</span><span class="n">wgts</span><span class="p">,</span> <span class="n">after_item</span><span class="o">=</span><span class="n">item_tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span> <span class="c1"># if len(wgts) != 8, this will fail&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">160</span>
<span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">())</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">weighted_dataloaders</span><span class="p">(</span><span class="n">wgts</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">bs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">synth_learner</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dls</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">CollectDataCallback</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="o">*</span><span class="n">learn</span><span class="o">.</span><span class="n">collect_data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">itemgot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">numpy</span><span class="p">());</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0, nan, None, &#39;00:00&#39;]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PartialDL" class="doc_header"><code>class</code> <code>PartialDL</code><a href="https://github.com/fastai/fastai/tree/master/fastai/callback/data.py#L38" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PartialDL</code>(<strong><code>dataset</code></strong>=<em><code>None</code></em>, <strong><code>bs</code></strong>=<em><code>None</code></em>, <strong><code>partial_n</code></strong>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong><code>num_workers</code></strong>=<em><code>None</code></em>, <strong><code>verbose</code></strong>=<em><code>False</code></em>, <strong><code>do_setup</code></strong>=<em><code>True</code></em>, <strong><code>pin_memory</code></strong>=<em><code>False</code></em>, <strong><code>timeout</code></strong>=<em><code>0</code></em>, <strong><code>batch_size</code></strong>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>=<em><code>False</code></em>, <strong><code>indexed</code></strong>=<em><code>None</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>persistent_workers</code></strong>=<em><code>False</code></em>, <strong><code>wif</code></strong>=<em><code>None</code></em>, <strong><code>before_iter</code></strong>=<em><code>None</code></em>, <strong><code>after_item</code></strong>=<em><code>None</code></em>, <strong><code>before_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_batch</code></strong>=<em><code>None</code></em>, <strong><code>after_iter</code></strong>=<em><code>None</code></em>, <strong><code>create_batches</code></strong>=<em><code>None</code></em>, <strong><code>create_item</code></strong>=<em><code>None</code></em>, <strong><code>create_batch</code></strong>=<em><code>None</code></em>, <strong><code>retain</code></strong>=<em><code>None</code></em>, <strong><code>get_idxs</code></strong>=<em><code>None</code></em>, <strong><code>sample</code></strong>=<em><code>None</code></em>, <strong><code>shuffle_fn</code></strong>=<em><code>None</code></em>, <strong><code>do_batch</code></strong>=<em><code>None</code></em>) :: <a href="/data.core.html#TfmdDL"><code>TfmdDL</code></a></p>
</blockquote>
<p>Select randomly partial quantity of data at each epoch</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FilteredBase.partial_dataloaders" class="doc_header"><code>FilteredBase.partial_dataloaders</code><a href="https://github.com/fastai/fastai/tree/master/fastai/callback/data.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FilteredBase.partial_dataloaders</code>(<strong><code>partial_n</code></strong>, <strong><code>bs</code></strong>=<em><code>64</code></em>, <strong><code>shuffle_train</code></strong>=<em><code>None</code></em>, <strong><code>shuffle</code></strong>=<em><code>True</code></em>, <strong><code>val_shuffle</code></strong>=<em><code>False</code></em>, <strong><code>n</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>'.'</code></em>, <strong><code>dl_type</code></strong>=<em><code>None</code></em>, <strong><code>dl_kwargs</code></strong>=<em><code>None</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>, <strong><code>drop_last</code></strong>=<em><code>None</code></em>, <strong><code>val_bs</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create a partial dataloader <a href="/callback.data.html#PartialDL"><code>PartialDL</code></a> for the training set</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">partial_dataloaders</span><span class="p">(</span><span class="n">partial_n</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span>
<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dls</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">==</span><span class="mi">16</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

